{% extends "core/base.html" %}

{% block title %}Flux{% endblock %}

{% block content %}
<div class="card">
  <div class="card__pad">

    <div class="header">
      <div>
        <h1 class="h1">{{ title }}</h1>
        <p class="sub">Informations du flux</p>
      </div>
    </div>

    <form method="post" class="form">
      {% csrf_token %}

      {% for field in form %}
      <div class="field">
        {{ field.label_tag }}
        {% if field.name == "couleur_flux" %}
          <div style="display: flex; gap: 10px; align-items: center;">
            {{ field }}
            <input
              type="text"
              id="couleur_flux_text"
              placeholder="#RRGGBB"
              style="max-width: 120px;"
            >
          </div>
        {% else %}
          {{ field }}
        {% endif %}
        {{ field.errors }}
      </div>
      {% endfor %}

      <div class="actions">
        <button class="btn btn--primary" type="submit">Enregistrer</button>
        <a href="{% url 'core:flux_list' %}" class="btn btn--ghost">Annuler</a>
      </div>
    </form>

  </div>
</div>
<script>
  const colorInput = document.querySelector('input[name="couleur_flux"]');
  const hexInput = document.getElementById("couleur_flux_text");
  if (colorInput && hexInput) {
    const syncFromColor = () => {
      hexInput.value = colorInput.value || "";
    };
    const syncFromHex = () => {
      const v = hexInput.value.trim();
      if (/^#([0-9a-fA-F]{6})$/.test(v)) {
        colorInput.value = v;
      }
    };
    syncFromColor();
    colorInput.addEventListener("input", syncFromColor);
    hexInput.addEventListener("input", syncFromHex);
  }
</script>
{% endblock %}
