{% extends "core/base.html" %}
{% load static %}


{% block title %}RÃ©gie de collecte{% endblock %}

{% block content %}


<div class="card">
  <div class="card__pad header">
    <div>
      <h1 class="h1">Bienvenue</h1>
      <p class="sub">Gerez vos agents, vehicules, flux et energies.</p>
    </div>
    <div class="nav__actions">
      <a class="btn btn--primary" href="{% url 'core:agent_list' %}">Voir les agents</a>
      <a class="btn" href="{% url 'core:vehicule_list' %}">Voir les vehicules</a>
    </div>
  </div>
</div>

<div class="card" style="margin-top: 16px;">
  <div class="card__pad">
    <form class="form" method="get">
      <div class="planning__controls">
        <div class="planning__control">
          <label class="planning__label" for="date_debut">Date debut</label>
          <input
            class="input"
            type="date"
            id="date_debut"
            name="date_debut"
            value="{{ date_debut|date:'Y-m-d' }}"
          />
        </div>
        <div class="planning__control">
          <label class="planning__label" for="date_fin">Date fin</label>
          <input
            class="input"
            type="date"
            id="date_fin"
            name="date_fin"
            value="{{ date_fin|date:'Y-m-d' }}"
          />
        </div>
        <div class="planning__control">
          <button class="btn btn--primary" type="submit">Filtrer</button>
        </div>
      </div>
    </form>
  </div>
</div>

<div class="card" style="margin-top: 16px;">
  <div class="card__pad">
    <h2 class="h2">Stats par flux</h2>
  </div>
  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th>Flux</th>
          <th class="right">NbTournees</th>
          <th class="right">Tonnage (t)</th>
          <th class="right">NbVidage</th>
          <th class="right">Tonnage moyen (t)</th>
        </tr>
      </thead>
      <tbody>
        {% for row in stats %}
          <tr>
            <td>{{ row.flux|default:"-" }}</td>
            <td class="right">{{ row.nb_tournees }}</td>
            <td class="right">{{ row.tonnage|floatformat:2 }}</td>
            <td class="right">{{ row.nb_vidages }}</td>
            <td class="right">{{ row.tonnage_moyen|floatformat:2 }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="5">Aucune donnee pour la periode.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>



<script src="{% static 'core/js/chart.js' %}"></script>
<script src="{% static 'core/js/dashboard.js' %}"></script>




{% endblock %}


